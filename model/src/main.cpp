#include "Forest.h"
#include <bits/stdc++.h>
#include "utils.h"

using namespace std;

int main() {
	std::vector<std::vector<std::string>> data_test = {
		{"54.96714153011233", "115.82063894086093", "176.22437784701899", "12.596732571205862", "B", "Y", "blue", "medium", "0"},
		{"48.61735698828815", "81.81225090410521", "196.55790675599303", "17.66369456501289", "C", "X", "green", "medium", "0"},
		{"56.47688538100692", "128.05588621872198", "215.1496183694137", "9.456199257715712", "A", "X", "green", "low", "0"},
		{"65.23029856408026", "71.96297874415438", "225.97265582510363", "12.008558610494706", "A", "X", "red", "low", "0"},
		{"47.658466252766644", "111.73714187600541", "163.9911077883267", "13.450719958555563", "B", "Y", "red", "medium", "0"},
		{"47.6586304305082", "143.80911251619958", "189.96496292477156", "7.993897640570818", "B", "Y", "red", "high", "0"},
		{"65.79212815507391", "80.18927349738624", "185.75164066517132", "11.120462409052084", "B", "X", "red", "low", "0"},
		{"57.67434729152909", "88.67404540794456", "180.40012302278865", "10.062962003908975", "A", "Y", "green", "high", "0"},
		{"45.30525614065048", "101.99302730175282", "252.9636272084329", "10.48838049274416", "C", "Y", "blue", "medium", "0"},
		{"55.42560043585965", "89.93048691767602", "212.14945132882866", "6.134951080722668", "A", "Y", "green", "medium", "0"},
		{"45.365823071875376", "68.98673137867735", "162.17348136994866", "10.122550871294713", "B", "Y", "red", "low", "0"},
		{"45.34270246429743", "101.37125949612054", "227.5358584116433", "12.489991456227248", "C", "Y", "green", "medium", "0"},
		{"52.41962271566034", "78.7539257254779", "263.664685910379", "17.25571803897521", "C", "X", "blue", "low", "0"},
		{"30.86719755342202", "109.47184861270364", "230.9739578165344", "14.796354130426035", "A", "Y", "blue", "medium", "0"},
		{"32.75082167486967", "81.61151531532394", "154.4189010213796", "20.765912287557782", "B", "X", "green", "medium", "0"},
		{"44.37712470759027", "130.9986881003508", "185.47297781401247", "6.163262185559752", "A", "Y", "green", "low", "0"},
		{"39.87168879665576", "84.33493415327526", "238.00733447559867", "14.36160318360339", "C", "X", "green", "low", "0"},
		{"53.142473325952736", "93.55876967588648", "178.76991603143657", "10.916710028691758", "A", "Y", "red", "low", "0"},
		{"40.91975924478789", "116.27034434739339", "213.31458284438685", "20.94901466608836", "A", "X", "green", "medium", "0"},
		{"35.87696298664709", "75.3827136713209", "223.23902160288011", "5.958508573224242", "B", "Y", "green", "medium", "0"},
		{"64.65648768921554", "104.54919869208258", "172.1920858526575", "5.80139078909612", "B", "X", "green", "high", "0"},
		{"47.74223699513465", "126.14285508564856", "198.21423931814599", "7.00303677277989", "C", "Y", "blue", "low", "0"},
		{"50.67528204687924", "67.85033530877544", "102.76197979792782", "-0.6194786215490353", "A", "X", "blue", "medium", "0"},
		{"35.75251813786544", "103.69267717064608", "169.2683707599713", "7.371224891596195", "A", "Y", "red", "medium", "0"},
		{"44.556172754748175", "105.19765588496847", "192.4229554582052", "6.20433669223151", "A", "X", "red", "low", "0"},
		{"51.10922589709866", "115.6364574355462", "162.5665045410545", "10.751968932381038", "C", "X", "blue", "high", "0"},
		{"38.490064225776976", "75.26098578243835", "248.97233911794905", "11.708779878885798", "C", "Y", "blue", "low", "0"},
		{"53.75698018345672", "73.59086773831447", "157.09575866118104", "19.380854196079433", "B", "Y", "blue", "high", "0"},
		{"43.99361310081195", "110.43883131233795", "186.79866539909048", "14.752119190930252", "B", "X", "green", "medium", "0"},
		{"47.083062502067236", "105.93969346466372", "203.92221731858274", "7.115481721687985", "B", "Y", "green", "high", "0"},
		{"43.98293387770603", "105.00985700691753", "243.23819867198347", "5.507926643258211", "A", "X", "blue", "medium", "0"},
		{"68.52278184508938", "106.9289641899395", "156.92413546461682", "12.459595857532529", "A", "X", "green", "low", "0"},
		{"49.86502775262066", "86.39950556843019", "234.8949125646488", "3.398833964896789", "B", "X", "green", "low", "0"},
		{"39.422890710440996", "104.64507394322007", "200.3069918305876", "19.15729382927177", "A", "Y", "red", "low", "0"},
		{"58.225449121031886", "105.86144946597362", "170.55474046856148", "15.897200603606436", "B", "X", "blue", "high", "0"},
		{"37.791563500289776", "85.71297163947264", "213.86310422789813", "7.6541217394764764", "C", "X", "blue", "medium", "0"},
		{"52.08863595004755", "137.31549022289514", "205.9717908672041", "1.434327354545612", "B", "Y", "green", "low", "0"},
		{"30.403298761202244", "109.47665841823576", "181.99349368523616", "16.769361870827062", "C", "Y", "blue", "low", "0"},
		{"36.71813951101569", "76.17393005594703", "202.09406254970057", "9.42730077373691", "A", "Y", "red", "medium", "0"},
		{"51.96861235869123", "113.1310721726766", "188.4405920941472", "16.189081559867308", "B", "Y", "red", "low", "0"},
		{"57.38466579995411", "80.50636659545357", "203.40552035753745", "2.0278617060281645", "A", "X", "red", "medium", "0"},
		{"51.7136828118997", "115.74169207484904", "219.8639202356314", "7.003124885231136", "C", "X", "blue", "medium", "0"},
		{"48.843517176117594", "123.17191158014808", "247.58050448436057", "10.026218498590916", "C", "X", "blue", "medium", "0"},
		{"46.98896304410711", "83.5863536329658", "162.8655350351945", "10.234902968823711", "C", "X", "blue", "medium", "0"},
		{"35.214780096325725", "119.26752258488644", "263.991001239688", "7.749672642603782", "A", "Y", "blue", "medium", "0"},
		{"42.801557916052914", "108.25561853872996", "141.43736601432494", "13.114249661737494", "A", "X", "blue", "high", "0"},
		{"45.393612290402125", "116.4412031998898", "195.4464471489325", "4.661897853087028", "A", "X", "red", "low", "0"},
		{"60.57122226218915", "137.93585965307895", "217.64951619453728", "9.288102574893532", "A", "Y", "green", "high", "0"},
		{"53.43618289568462", "95.09223767994258", "208.429756032051", "10.601478158559495", "C", "X", "red", "low", "0"},
		{"32.36959844637266", "84.9252767128502", "181.31901440538218", "12.572194170293745", "C", "X", "blue", "high", "0"},
		{"53.24083969394795", "82.20971140748954", "193.75633248928173", "13.55807439044445", "B", "X", "red", "medium", "0"},
		{"46.149177195836835", "83.68379430069123", "185.209971960235", "4.376789540810654", "B", "X", "blue", "low", "0"},
		{"43.23077999694041", "98.45796581171791", "182.31905729167366", "2.329429146321889", "A", "X", "blue", "low", "0"},
		{"56.11676288840868", "106.82303949633288", "225.48806291063073", "16.388384109492545", "C", "X", "red", "high", "0"},
		{"60.30999522495951", "105.53381598660039", "210.71046457895142", "11.661570059897958", "C", "Y", "blue", "high", "0"},
		{"59.31280119116199", "116.54366498072048", "179.21271214218038", "6.257567317217232", "C", "Y", "green", "low", "0"},
		{"41.607824767773614", "100.26003783755814", "226.9879962629975", "17.755759877612615", "B", "X", "blue", "high", "0"},
		{"46.907876241487855", "129.07068154314635", "209.2189856262983", "10.578373171464293", "B", "X", "green", "high", "0"},
		{"53.31263431403564", "94.70686333524088", "224.3858635651688", "15.896485920319133", "C", "Y", "green", "high", "0"},
		{"59.75545127122359", "154.40338333179238", "218.88886525770837", "10.337592407050545", "C", "X", "blue", "medium", "0"},
		{"45.2082576215471", "112.51334695530012", "175.13014967233784", "20.303739624409936", "C", "X", "red", "medium", "0"},
		{"48.14341023336183", "82.85684887167434", "183.1945687940909", "18.77670421221602", "B", "X", "green", "high", "0"},
		{"38.93665025993972", "78.58215003877775", "222.41880815369785", "8.755179257604633", "C", "Y", "red", "high", "0"},
		{"38.037933759193294", "109.64944830486371", "218.31110796300393", "14.857854754771777", "C", "X", "green", "medium", "0"},
		{"58.125258223941984", "95.53074429348298", "199.37295218107556", "13.226879747925738", "A", "Y", "blue", "medium", "0"},
		{"63.56240028570823", "114.28000988184183", "203.51982149926346", "16.843157787661745", "A", "X", "blue", "low", "0"},
		{"49.27989878419666", "109.4647524914709", "238.32994687365274", "5.175382697099478", "B", "Y", "green", "low", "0"},
		{"60.03532897892024", "98.54342174686255", "182.2528583349251", "13.430257299992196", "C", "Y", "blue", "medium", "0"},
		{"53.61636025047634", "83.06412563863191", "216.41292143510114", "15.29212243424794", "C", "X", "green", "high", "0"},
		{"43.54880245394876", "69.70305550628271", "193.9342204269832", "1.2063025678844284", "A", "Y", "blue", "high", "0"},
		{"53.61395605508414", "91.06970095865958", "193.4695639031834", "4.083707436671125", "B", "X", "red", "high", "0"},
		{"65.38036566465969", "117.12797588646944", "232.96330555961572", "-0.19616088880050242", "A", "Y", "blue", "high", "0"},
		{"49.64173960890049", "104.28187488260409", "224.7624904696409", "8.652965827777212", "A", "X", "red", "low", "0"},
		{"65.64643655814007", "75.08522442576023", "224.40528908001914", "13.58771127897981", "A", "X", "blue", "medium", "0"},
		{"23.802548959102555", "103.46361851702363", "239.16436421462987", "17.51178526048014", "A", "Y", "red", "high", "0"},
		{"58.21902504375224", "107.70634759457674", "200.63011524898278", "10.370473902098876", "C", "X", "blue", "low", "0"},
		{"50.870470682381715", "82.32285127597734", "220.4585891388489", "18.143077727856458", "C", "X", "red", "high", "0"},
		{"47.009926495341325", "103.07450211891056", "190.6919973021963", "3.099492708925543", "A", "Y", "green", "medium", "0"},
		{"50.91760776535502", "101.16417436892", "209.72499057465328", "1.483087803224226", "B", "X", "green", "low", "0"},
		{"30.124310853991073", "77.14059404338754", "196.09570836896947", "9.722261505516906", "B", "X", "red", "medium", "0"},
		{"47.80328112162488", "107.15574720696567", "202.90987894978156", "11.920327244696537", "B", "Y", "blue", "medium", "0"},
		{"53.57112571511746", "111.21569052736469", "217.85471076310742", "9.836526259529535", "B", "Y", "red", "low", "0"},
		{"64.77894044741517", "121.66102486350553", "175.45337950299583", "-0.33721050019938303", "A", "X", "blue", "low", "0"},
		{"44.81729781726352", "121.07604104069806", "262.7716182705638", "9.554399802436057", "C", "X", "green", "low", "0"},
		{"41.91506397106812", "72.44661264085818", "169.81947855500894", "3.4776524974757344", "B", "Y", "blue", "low", "0"},
		{"44.982429564154636", "81.24349920169755", "163.57434161636803", "13.348362744150192", "A", "Y", "green", "low", "0"},
		{"59.15402117702074", "110.3007053441732", "234.74332620500203", "11.832991230484241", "B", "X", "blue", "low", "0"},
		{"53.287511096596845", "110.27571901824417", "223.74988081888807", "5.300601068363224", "B", "Y", "blue", "low", "0"},
		{"44.70239796232961", "110.30095372612095", "218.72359451156467", "7.430665413316532", "A", "X", "blue", "high", "0"},
		{"55.13267433113356", "177.05462981309444", "218.8503652779284", "4.703932390555242", "C", "X", "red", "medium", "0"},
		{"50.9707754934804", "111.41781021386333", "199.63259681459257", "9.68660451363414", "C", "X", "red", "low", "0"},
		{"59.68644990532889", "122.71131280361197", "173.08236885542505", "14.775711602506192", "A", "X", "green", "high", "0"},
		{"42.979469061226474", "119.08003526986406", "202.2741367458118", "5.071369768322281", "C", "X", "green", "high", "0"},
		{"46.723378534022316", "113.02782502611596", "179.68514865463663", "12.520232577589223", "A", "Y", "red", "high", "0"},
		{"46.078918468678424", "93.69461510719309", "229.25359200253254", "7.348711908137796", "A", "Y", "green", "medium", "0"},
		{"35.364850518678814", "115.17938440986535", "195.58827855493584", "6.035635838688279", "A", "Y", "red", "low", "0"},
		{"52.96120277064576", "84.54349570924856", "175.23508409622465", "9.46484820022721", "C", "Y", "blue", "high", "0"},
		{"52.610552721798896", "95.26362786519982", "190.3584247504102", "4.82378838790313", "A", "X", "green", "medium", "0"},
		{"50.05113456642461", "90.29272904341794", "212.38794362826872", "7.23175347326409", "B", "X", "green", "medium", "0"},
		{"47.65412866624853", "101.63748278772646", "183.08826341588076", "4.010610537055758", "C", "X", "red", "medium", "0"},
		{"35.84629257949586", "146.29317133347018", "175.33338813300705", "19.823625664581947", "C", "X", "green", "high", "0"},
		{"45.79354677234641", "62.65469614816504", "207.31061634475736", "10.176317759858643", "C", "Y", "green", "low", "0"},
		{"46.572854834732304", "113.72520380749027", "207.3489971332617", "6.5013724600370715", "C", "X", "blue", "high", "0"},
		{"41.97722730778381", "67.74568257620697", "184.79170473886612", "11.06989955367111", "B", "X", "green", "high", "0"},
		{"48.387142883339905", "90.56136268421133", "185.86885083145032", "9.438359751545851", "C", "Y", "blue", "low", "0"},
		{"54.040508568145384", "121.77901193934733", "206.9614981207291", "8.895152002333885", "C", "Y", "red", "low", "0"},
		{"68.8618590121053", "101.28560038190926", "156.55746975508026", "13.070833500217127", "A", "Y", "green", "low", "0"},
		{"51.74577812831839", "78.44510444141387", "157.77608676870335", "13.787538550236526", "C", "Y", "blue", "medium", "0"},
		{"52.57550390722764", "85.69392581480064", "178.4466733624269", "7.347494261947363", "B", "X", "red", "low", "0"},
		{"49.25554084233833", "113.59195497869352", "193.5965854486446", "7.1209087967766", "B", "X", "green", "high", "0"},
		{"30.812287847009586", "85.39266736565727", "209.32722696794013", "8.62474151424178", "B", "Y", "red", "low", "0"},
		{"49.73486124550783", "104.3291717916395", "244.26068650848657", "-1.5096058236779246", "B", "X", "green", "high", "0"},
		{"50.60230209941027", "100.91143679807628", "225.72978869606058", "2.424044689007239", "C", "X", "red", "medium", "0"},
		{"74.63242112485287", "86.96799304788365", "195.20184410109718", "16.834371337222624", "C", "X", "red", "high", "0"},
		{"48.076390352188774", "142.8788817865065", "199.42951376291933", "18.224838567506417", "B", "Y", "blue", "high", "0"},
		{"53.015473423336125", "112.67838044636022", "169.92411906086573", "8.754819802218108", "B", "X", "red", "low", "0"},
		{"49.65288230294757", "59.49714826684786", "199.4446059202283", "12.882784815278832", "C", "Y", "green", "low", "0"},
		{"38.31321962380468", "103.72908629538856", "191.34024083239586", "11.55625077271768", "B", "X", "green", "high", "0"},
		{"61.42822814515021", "86.76427070463224", "209.6815568101427", "25.39440404227619", "A", "X", "blue", "low", "0"},
		{"57.519330326867745", "117.04866669592448", "175.18307169343032", "15.597874557172883", "B", "X", "green", "medium", "0"},
		{"221.43440226795522", "-56.83404537703206", "705.1984134948308", "55.74184123696018", "W", "Q", "yellow", "extreme", "1"},
		{"289.4824733646909", "-87.24196972044362", "991.1893084543033", "80.53100212208163", "W", "Q", "black", "extreme", "1"},
		{"306.5234532910046", "-71.62240942012755", "556.0194510840262", "64.43152766201278", "W", "Q", "yellow", "extreme", "1"},
		{"248.49410072694593", "-63.69177036013649", "698.9277995228708", "79.06191107113061", "Z", "Q", "yellow", "extreme", "1"},
		{"253.8486461898762", "-35.40827586683987", "984.7352166376844", "57.718135763710116", "W", "Q", "black", "extreme", "1"},
		{"275.4568326209245", "-42.922169533108814", "932.7535629469901", "74.05700509274087", "Z", "Q", "yellow", "extreme", "1"},
		{"204.01423955554526", "-64.39032741021538", "908.5360354746399", "76.62947162757929", "W", "Q", "black", "extreme", "1"},
		{"264.41583311663567", "-1.3484751207020338", "628.9514135224699", "52.591176841121346", "Z", "Q", "black", "extreme", "1"},
		{"242.28960139930894", "-39.422518064311284", "585.4437936950329", "66.83021390969603", "Z", "Q", "black", "extreme", "1"},
		{"265.4994704355829", "-76.27732082640055", "834.3216099622155", "56.72073384694871", "W", "Q", "black", "extreme", "1"},
		{"223.95242636385024", "-89.82175273795963", "964.6879945637929", "53.168748523638385", "Z", "Q", "black", "extreme", "1"},
		{"378.105456147979", "-84.71408608156679", "778.381446506965", "99.49801161949726", "Z", "Q", "yellow", "extreme", "1"},
		{"318.71849071080976", "-75.40422716154919", "785.8063447349499", "66.11769224873615", "W", "Q", "yellow", "extreme", "1"},
		{"335.8204638288979", "-83.93186267404442", "639.9895468301421", "90.49372229273175", "Z", "Q", "yellow", "extreme", "1"},
		{"357.83424772146765", "-81.34329759486943", "884.7464665959685", "62.732032738188195", "W", "Q", "black", "extreme", "1"},
		{"299.68843978581145", "-71.49048313061529", "593.5218742787617", "84.07513611119646", "W", "Q", "black", "extreme", "1"},
		{"217.38405761748473", "-82.66264047052452", "661.8396182021219", "88.01139299448432", "W", "Q", "black", "extreme", "1"},
		{"307.42130836370956", "-10.323457537357484", "712.7182193082084", "79.78193703039221", "Z", "Q", "yellow", "extreme", "1"},
		{"317.3682236041758", "-91.97662543383578", "753.8051893422275", "73.57880942750792", "Z", "Q", "black", "extreme", "1"},
		{"349.087894836866", "-47.548861042974536", "621.2048662075401", "70.59204570736343", "Z", "Q", "yellow", "extreme", "1"}
	};

	Forest forest(5000, 500);
	forest.fit(data_test);

	vector<double> scores;

	for (auto& x : data_test) {
		scores.push_back(forest.anomaly_score(x));
	}

	vector<bool> outliers = ut::hip_test(scores, 1.5);

	for (size_t i = 0; i < scores.size(); i++) {
		cout << "(" << data_test[i][0] << "," << data_test[i][1] << ") -> Score: " << scores[i] << " -> " << (outliers[i] ? "Outlier" : "Normal") << endl;
	}

	return 0;
}
